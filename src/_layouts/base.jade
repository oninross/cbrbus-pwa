include ../_modules/primary-nav/primary-nav

//- Custom Configuration
block config
    //- Setup site's base URL to match the "baseUrl" key within `package.json`
    //- Otherwise default to relative pathing
    - var baseUrl = config.baseUrl || './'
    - var isBusStop = config.isBusStop || false
    - var isSearch = config.isSearch || false

doctype html

<!--[if lt IE 9]>
<html class='lt-ie9 no-js' lang='en'>
<![endif]-->
<!--[if gte IE 9]><!-->
<html class='no-js' lang='en'>
<!--<![endif]-->

head
    meta(charset='utf-8')
    meta(http-equiv='X-UA-Compatible', content='IE=edge,chrome=1')

    title CBR Buses

    meta(name='description', content= 'CBR Buses')
    meta(name='viewport', content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no')

    link(rel='manifest', href='manifest.json')
    meta(name='mobile-web-app-capable', content='yes')
    meta(name='apple-mobile-web-app-capable', content='yes')
    meta(name='msapplication-TileColor', content='#383838')
    meta(name='msapplication-TileImage', content='/assets/btt/images/favicon/ms-icon-144x144.png')
    meta(name='theme-color', content='#383838')

    link(rel='apple-touch-icon', sizes='57x57', href='/assets/btt/images/favicon/apple-icon-57x57.png')
    link(rel='apple-touch-icon', sizes='60x60', href='/assets/btt/images/favicon/apple-icon-60x60.png')
    link(rel='apple-touch-icon', sizes='72x72', href='/assets/btt/images/favicon/apple-icon-72x72.png')
    link(rel='apple-touch-icon', sizes='76x76', href='/assets/btt/images/favicon/apple-icon-76x76.png')
    link(rel='apple-touch-icon', sizes='114x114', href='/assets/btt/images/favicon/apple-icon-114x114.png')
    link(rel='apple-touch-icon', sizes='120x120', href='/assets/btt/images/favicon/apple-icon-120x120.png')
    link(rel='apple-touch-icon', sizes='144x144', href='/assets/btt/images/favicon/apple-icon-144x144.png')
    link(rel='apple-touch-icon', sizes='152x152', href='/assets/btt/images/favicon/apple-icon-152x152.png')
    link(rel='apple-touch-icon', sizes='180x180', href='/assets/btt/images/favicon/apple-icon-180x180.png')

    link(rel='icon', type='image/png', sizes='192x192', href='/assets/btt/images/favicon/android-icon-192x192.png')

    link(rel='icon', type='image/png', sizes='32x32', href='/assets/btt/images/favicon/favicon-32x32.png')
    link(rel='icon', type='image/png', sizes='96x96', href='/assets/btt/images/favicon/favicon-96x96.png')
    link(rel='icon', type='image/png', sizes='16x16', href='/assets/btt/images/favicon/favicon-16x16.png')

    block stylesheets
        link(rel='stylesheet', href= baseUrl + 'assets/btt/css/main.css')

body
    <!--[if lt IE 9]>
    <p class='browsehappy'>You are using an <strong>outdated</strong> browser. Please <a href='http://browsehappy.com/'>upgrade your browser</a> to improve your experience.</p>
    <![endif]-->

    if !isTablePreview
        header.header
            .logo
                .container
                    h1
                        a(href="/") CBR Buses
            +primary-nav

    if isBusStop
        .loader
            svg.circular(viewbox='25 25 50 50')
                circle.path(cx='50', cy='50', r='18', fill='none', stroke-width='3', stroke-miterlimit='10')

    main#main
        block content

    block scripts
        script(src= baseUrl + 'assets/btt/js/main.js')

        script(id='toaster-template', type='text/template').
            .toaster(class='toaster{{= it.ind }}')
                .container
                    p {{! it.message}}
                    button.js-dismiss
                        span.vh Close
                        i.icon.icon-cross

        script#card-header(type='text/template')
            button.card.card__header.js-bookmark(data-id='{{! it.busStopId }}')
                h2 {{! it.busStopName }}
                i.icon.icon-star(class=' {{! it.isBookmarked }}')

        script#card-bookmark(type='text/template')
            a.card.card__header(href='/busstop/?busStopId={{! it.busStopId }}&busStopName={{! it.busStopName }}')
                h2 {{! it.busStopId }} - {{! it.busStopName }}
                i.icon.icon-star.active

        script#card-template(type='text/template')
            .card(data-servicenum='{{! it.serviceNo }}')
                .wrap
                    .col-3
                        p {{! it.serviceNo }}
                    .feature.col-4
                        |{{? it.feature.length > 0 }}
                        |{{~ it.feature :value:index }}
                        i.icon(class='icon-{{= value}}')
                        |{{~ }}
                        |{{? }}
                    .eta.col-5
                        | {{? it.estimatedArrival < 0 }}
                        p.departed Departed
                        | {{?? it.estimatedArrival == 0 }}
                        p.due Due
                        | {{?? it.estimatedArrival == 1 }}
                        p.arriving Arriving
                        | {{??}}
                        p {{! it.estimatedArrival }} mins
                        | {{?}}

        script#card-empty-template(type='text/template')
            .card.warning
                .wrap
                    .col-12.align-center
                        p No departures found

        script.
            (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='https://www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-XXXXX-X','auto');ga('send','pageview');
